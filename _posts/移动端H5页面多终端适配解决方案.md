title: 移动端H5页面多终端适配解决方案
date: 2015-11-02 20:57:20
tags: [Html5,移动端,JavaScript]
---
## 开发背景：
1.移动端Html5页面开发
2.适配不同分辨率的手机
3.适配不同屏幕尺寸的手机

## 开发工具
1.Sublime编辑器:页面开发
2.BrowserSync终端:监测文件,搭建本地服务器,多终端页面实时刷新（告别F5手党哈哈哈~~）
3.LiveStyle:配合chrome，进行面板调试css,实时缓存css文件

## 进入主题
    先说下一些基本的概念，普及下
<!-- more -->
### 物理像素(physical pixel)
一个物理像素是显示器(手机屏幕)上最小的物理显示单元，在操作系统的调度下，每一个设备像素都有自己的颜色值和亮度值。

### 设备独立像素(density-independent pixel)
设备独立像素(也叫密度无关像素)，可以认为是计算机坐标系统中得一个点，这个点代表一个可以由程序使用的虚拟像素(比如: css像素)，然后由相关系统转换为物理像素。

### 设备像素比(device pixel ratio )
官方定义：设备物理像素和设备独立像素的比例

    设备像素比 = 物理像素 / 设备独立像素 // 在某一方向上，x方向或者y方向

总结下：css中的1px并不等于设备的1px,在pc端浏览器中css的1个像素往往对应着电脑屏幕的一个物理像素。但是css的像素是个抽象的单位。
举个例子：比如`iPhone3`的分辨率为320 * 480，在那个年代一个css像素确实等于一个屏幕物理像素。但是技术水平高了，苹果推出了Retina屏，屏幕越来越细腻了。
例如：在`Retina`屏的iPhone上，`devicePixeRatio`值为2，也就是说一个css像素相当于2个物理像素。
## 解决思路
### 1.viewport 简单粗暴的方式：

`<meta name="viewport" content="width=320,maximum-scale=1.3,user-scalable=no">`

> * **initial-scale** - 初始的缩放比例
> * **minimum-scale** - 允许用户缩放到的最小比例
> * **maximum-scale** - 允许用户缩放到的最大比例
> * **user-scalable** - 用户是否可以手动缩放


直接设置`viewport`为320px的1.3倍，将页面放大1.3倍
目前大部分页面都是以320px为基准的布局，而iphone6的宽度比是375/320 = 1.171875，iphone6+则是 414/320 = 1.29375
那么以1.29倍也就约等于1.3了。

### 2.iPhone6+ 的CSS media query
```css
/*320px布局*/
html{font-size: 100px;}
body{font-size: 0.14rem /*实际相当于14px*/}

/* iphone 6 */
@media (min-device-width : 375px) and (max-device-width : 667px) and (-webkit-min-device-pixel-ratio : 2){
    html{font-size: 117.1875px;}
}
/* iphone6 plus */
@media (min-device-width : 414px) and (max-device-width : 736px) and (-webkit-min-device-pixel-ratio : 3){
    html{font-size: 129.375px;}
}
```
不过用媒体查询的方式好像不是很精确。具体看下面js的方案

### 3.JS去动态计算根元素的font-size
```js
(function (doc, win) {
  var docEl = doc.documentElement,
    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
    recalc = function () {
      var clientWidth = docEl.clientWidth;
      if (!clientWidth) return;
      docEl.style.fontSize = 20 * (clientWidth / 320) + 'px';
    };

  if (!doc.addEventListener) return;
  win.addEventListener(resizeEvt, recalc, false);
  doc.addEventListener('DOMContentLoaded', recalc, false);
})(document, window);
```
页面初始化的时候计算font-size，然后再绑定resize事件。这种效果就和百分比布局一样了。


## 其他解决方案
`github`上找到的一些解决方案分享下：

1.使用transform:scale属性缩放页面，这个还真没想到。
[https://github.com/peunzhang/pageResponse](https://github.com/peunzhang/pageResponse)
[https://github.com/ufologist/responsive-page](https://github.com/ufologist/responsive-page)
2.阿里无线伸缩布局方案：
[https://github.com/amfe/lib-flexible](https://github.com/amfe/lib-flexible)


